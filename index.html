<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <title>Diagrammes Aléatoires Variables</title>
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f7fc;
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
      height: 100vh;
      overflow-x: hidden;
    }

    .header {
      width: 100%;
      position: sticky;
      top: 0;
      background-color: #fff;
      padding: 20px 0;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      text-align: center;
      z-index: 10;
    }

    .header h1 {
      font-size: 36px;
      color: #333;
    }

    .header h1 span {
      font-size: 40px;
      color: #1D4E89;
    }

    .printer-button {
  font-size: 32px; /* Increase font size to better fit the icon */
  padding: 15px;   /* Adjust padding for better appearance */
  background-color: #ecf0f1; /* Lighter color */
  color: #2c3e50; /* Dark text */
  border: none;
  border-radius: 5px;
  cursor: pointer;
  position: fixed; /* Change to fixed so it stays in place while scrolling */
  top: 10px; /* Move higher */
  left: 20px;
  z-index: 9999; /* Ensure it's on the topmost layer */
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
}


    .printer-button i {
      font-size: 32px; /* Increase icon size */
    }

    .button-container {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 15px;
    }

    .button-container button {
      padding: 8px 15px;
      font-size: 14px;
      border: none;
      border-radius: 8px;
      background-color: #3498db;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .button-container button.selected {
      background-color: #45a049;
    }

    .button-container button:hover {
      background-color: #2980b9;
    }

    .game-container {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      flex-grow: 1;
      padding-top: 20px;
      width: 100%;
      max-width: 1200px;
      box-sizing: border-box;
      overflow-y: auto; /* Ensure content is scrollable */
    }

    .canvas-container {
      width: 100%;
      max-width: 650px;
      text-align: center;
    }

    .canvas-container canvas {
      width: 100%;
      height: auto;
      max-height: 250px;
      border: none;
      background-color: #f7f7f7;
    }

    .elements-container {
      width: 100%;
      max-width: 650px;
      background-color: #ffffff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      text-align: center;
      margin-top: 20px;
    }

    .table-container {
      margin: 10px 0;
      text-align: center;
      display: inline-block;
    }

    .table-container table {
      margin: 0 auto;
      border-collapse: collapse;
      width: 100%;
    }

    .table-container th, .table-container td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: center;
    }

    .table-container th {
      background-color: #3498db;
      color: white;
    }

    .table-container tr:nth-child(even) {
      background-color: #f9f9f9;
    }

    .extra-fields {
      margin-top: 20px;
      font-size: 24px;
      font-weight: bold;
    }

    .round-title {
      font-size: 24px;
      font-weight: bold;
      color: #333;
      margin-bottom: 20px;
    }

    .diagramme-button {
      font-size: 14px;
      padding: 6px 12px;
      background-color: #2c3e50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .date-time-container {
      font-size: 14px;
      color: lightgrey;
      margin-top: 20px;
    }

    .date-time-container span {
      display: block;
    }

    .button-container .button {
      margin-top: 20px;
    }

    .btn-zd, .btn-za {
      padding: 8px 15px;
      font-size: 14px;
      border: none;
      border-radius: 8px;
      background-color: #3498db;
      color: white;
      cursor: pointer;
      margin: 5px;
    }

    .btn-za {
      background-color: #2d6a4f; /* Dark Green for ZA */
    }

    .btn-zd {
      background-color: #1a3c6c; /* Darker Blue for ZD */
    }

    .btn-zd:hover, .btn-za:hover {
      background-color: #2980b9;
    }

    @media (max-width: 768px) {
      .game-container {
        flex-direction: column;
      }
      .table-container, .canvas-container {
        width: 100%;
      }
    }

    .ball {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: inline-block;
      margin: 0 auto;
      text-align: center;
      line-height: 30px;
      color: white;
      font-weight: bold;
      font-size: 14px;
      display: inline-block;
    }

    .ball-number {
      font-size: 12px;
      color: white;
      font-weight: bold;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
  </style>
</head>
<body>

  <!-- Date and time display above the game container -->
  <div class="date-time-container">
    <span>Diagrammes générés le : <strong id="currentDateTime"></strong></span>
  </div>

  <!-- Printer button placed to the left of the screen -->
  <div class="printer-button" onclick="exportGameCoordinates()">
    <i class="fa fa-print"></i> <!-- Printer Icon -->
  </div>

  <div class="header">
    <h1><span>D</span>iagramme <span>A</span>léatoires <span>V</span>ariables</h1>
  </div>

  <div class="button-container">
    <button onclick="showGame(0)">1</button>
    <button onclick="showGame(1)">2</button>
    <button onclick="showGame(2)">3</button>
    <button onclick="showGame(3)">4</button>
    <button onclick="showGame(4)">5</button>
    <button onclick="showGame(5)">6</button>
    <button onclick="showGame(6)">7</button>
    <button onclick="showGame(7)">8</button>
    <button onclick="showGame(8)">9</button>
    <button onclick="showGame(9)">10</button>
  </div>

  <div class="game-container" id="gameContainer"></div>

  <script>
    const games = [];
    let currentGameIndex = 0;

    function getRandomNumber(max) {
      return Math.floor(Math.random() * (max + 1));
    }

    function generateUniqueRandomNumberPairs(count) {
      let uniquePairs = new Set();
      while (uniquePairs.size < count) {
        let pair = [getRandomNumber(16), getRandomNumber(8)];
        uniquePairs.add(pair.toString());
      }
      return Array.from(uniquePairs).map(pair => pair.split(",").map(Number));
    }

    function getColor(number) {
      const colors = [
        "yellow", "blue", "red", "purple", "orange",
        "green", "maroon", "black", "yellow", "blue",
        "red", "purple", "orange", "green", "maroon",
      ];
      return colors[number - 1] || "white";
    }

function drawGrid(ctx, width, height) {
  ctx.strokeStyle = "#ddd";
  const xSpacing = width / 18;
  const ySpacing = height / 10;

  // Draw the vertical grid lines
  for (let x = 0; x <= 16; x++) {
    let xPos = (x + 1) * xSpacing;
    ctx.beginPath();
    ctx.moveTo(xPos, 0);
    ctx.lineTo(xPos, height);
    ctx.stroke();
    
    // Draw black lines over the 1st, 5th, 9th, 13th, and 17th vertical lines (indices 0, 4, 8, 12, 16)
    if (x === 0 || x === 4 || x === 8 || x === 12 || x === 16) {
      ctx.strokeStyle = "grey"; // Change stroke color to black
      ctx.beginPath();
      ctx.moveTo(xPos, 0);
      ctx.lineTo(xPos, height);
      ctx.stroke();
      ctx.strokeStyle = "#ddd"; // Reset stroke color back to light grey
    }
  }

  // Draw the horizontal grid lines
  for (let y = 0; y <= 8; y++) {
    let yPos = height - (y + 1) * ySpacing;
    ctx.beginPath();
    ctx.moveTo(0, yPos);
    ctx.lineTo(width, yPos);
    ctx.stroke();
    
    // Draw black lines over the 1st, 4th, and 9th horizontal lines (indices 0, 3, 8)
    if (y === 0 || y === 4 || y === 8) {
      ctx.strokeStyle = "grey"; // Change stroke color to black
      ctx.beginPath();
      ctx.moveTo(0, yPos);
      ctx.lineTo(width, yPos);
      ctx.stroke();
      ctx.strokeStyle = "#ddd"; // Reset stroke color back to light grey
    }
  }

  // Write numbers 0 to 16 in the last row (index 8 in the grid, which is the last horizontal line)
  const lastRowYPos = height - ySpacing / 2; // Adjust Y position for the numbers
  ctx.fillStyle = "black"; // Set text color to black
  ctx.font = "bold 16px Arial";
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";

  for (let i = 0; i <= 16; i++) {
    let xPos = (i + 1) * xSpacing;
    ctx.fillText(i, xPos, lastRowYPos); // Draw the number at each X position
  }

  // Write numbers 0 to 8 in the first column (starting from the top)
  const firstColumnXPos = xSpacing / 2; // Position for the first column, at the left side of the canvas
  for (let i = 0; i <= 8; i++) {
    let yPos = height - (i + 1) * ySpacing + ySpacing / 2 - 13; // Move the numbers slightly higher to align with the horizontal lines
    ctx.fillText(i, firstColumnXPos, yPos); // Draw the number in the first column
  }
}




    function drawCircles(ctx, pairs) {
      pairs.forEach((pair, index) => {
        let x = (pair[0] + 1) * (ctx.canvas.width / 18);
        let y = ctx.canvas.height - ((pair[1] + 1) * (ctx.canvas.height / 10));

        ctx.beginPath();
        ctx.arc(x, y, 10, 0, 2 * Math.PI); // Circle radius set to 10
        ctx.fillStyle = getColor(index + 1);
        ctx.fill();
        ctx.strokeStyle = "black";
        ctx.stroke();

        ctx.fillStyle = (index + 1 === 1 || index + 1 === 9) ? "black" : "white";
        ctx.font = "12px Arial";
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.fillText(index + 1, x, y); // Centered text inside circle
      });
    }

    function drawTableAndCircles(canvas, pairs) {
      let ctx = canvas.getContext("2d");
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawGrid(ctx, canvas.width, canvas.height);
      drawCircles(ctx, pairs);
    }

    function generateGames() {
      for (let i = 1; i <= 10; i++) {
        const elementsContainer = document.createElement("div");
        elementsContainer.className = "elements-container";
        elementsContainer.style.display = i === 1 ? "block" : "none";

        const roundTitle = document.createElement("div");
        roundTitle.className = "round-title";
        
        const ball = document.createElement("span");
        ball.className = "ball";
        ball.style.backgroundColor = getColor(i); // Boule avec la couleur correspondante
        ball.textContent = i;

        // Applique du style noir aux boules 1 et 9
        if (i === 1 || i === 9) {
          roundTitle.innerHTML = `Diagramme avec <span class="ball" style="background-color: ${getColor(i)}; color: black;">${ball.textContent}</span> boule${i > 1 ? 's' : ''}`;
        } else {
          roundTitle.innerHTML = `Diagramme avec ${ball.outerHTML} boule${i > 1 ? 's' : ''}`;
        }

        let zd = getRandomNumber(8);
        let za = getRandomNumber(8);
        while (zd === za) {
          za = getRandomNumber(8);
        }

        const extraFields = document.createElement("div");
        extraFields.className = "extra-fields";
        extraFields.innerHTML = `
          <button class="btn-zd">ZD: ${zd}</button>
          <button class="btn-za">ZA: ${za}</button>
        `;

        elementsContainer.appendChild(roundTitle);
        elementsContainer.appendChild(extraFields);

        const tableContainer = document.createElement("div");
        tableContainer.className = "table-container";
        const table = document.createElement("table");
        table.innerHTML = `
          <tr>
            <th>Boules</th>
            <th>Position</th>
          </tr>
        `;
        const pairs = generateUniqueRandomNumberPairs(i);
        pairs.forEach((pair, index) => {
          const row = table.insertRow();
          const cell1 = row.insertCell(0);
          const cell2 = row.insertCell(1);
          cell2.textContent = `H${pair[0]} / V${pair[1]}`; // Modified format here

          const ball = document.createElement("span");
          ball.className = "ball";
          ball.style.backgroundColor = getColor(index + 1);
          ball.textContent = index + 1;

          // Application de la couleur de texte noir pour les boules 1 et 9
          if (index + 1 === 1 || index + 1 === 9) {
            ball.style.color = "black";
          }
          
          cell1.appendChild(ball);
        });

        tableContainer.appendChild(table);
        elementsContainer.appendChild(tableContainer);

        const canvasContainer = document.createElement("div");
        canvasContainer.className = "canvas-container";
        const canvas = document.createElement("canvas");
        canvas.width = 650;
        canvas.height = 250;
        canvas.style.display = "none";
        canvasContainer.appendChild(canvas);

        elementsContainer.appendChild(canvasContainer);
        drawTableAndCircles(canvas, pairs);

        games.push({ elementsContainer, pairs, canvas });

        const diagrammeButton = document.createElement("button");
        diagrammeButton.className = "diagramme-button";
        diagrammeButton.textContent = "Diagramme";
        diagrammeButton.onclick = function() {
          canvas.style.display = canvas.style.display === "none" ? "block" : "none";
        };
        
        elementsContainer.appendChild(diagrammeButton);
      }
    }

    function showGame(index) {
      if (index >= 0 && index < games.length) {
        games.forEach((game, i) => {
          game.elementsContainer.style.display = i === index ? "block" : "none";
        });

        const buttons = document.querySelectorAll(".button-container button");
        buttons.forEach((button, i) => {
          button.classList.toggle("selected", i === index);
        });

        document.getElementById("gameContainer").innerHTML = "";
        document.getElementById("gameContainer").appendChild(games[index].elementsContainer);
      }
    }

    function exportGameCoordinates() {
  let content = "Coordinates of all games:\n\n";
  
  // Add date to the filename
  const currentDate = new Date().toLocaleDateString().replace(/\//g, '-'); // Format the date
  const filename = `DAVE10_${currentDate}.txt`;
  
  games.forEach((game, i) => {
    content += `Game ${i + 1}:\n`;
    // Include ZD and ZA
    const zdZaButtons = game.elementsContainer.querySelectorAll(".btn-zd, .btn-za");
    const zd = zdZaButtons[0].textContent.split(":")[1].trim();
    const za = zdZaButtons[1].textContent.split(":")[1].trim();
    
    content += `ZD: ${zd}, ZA: ${za}\n`;
    
    game.pairs.forEach(pair => {
      content += `H${pair[0]} / V${pair[1]}\n`;
    });
    
    content += "\n";
  });

  const blob = new Blob([content], { type: "text/plain" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = filename; // Use the formatted filename
  link.click();
}


    generateGames();
    showGame(currentGameIndex);

    // Display current date and time
    const currentDateTime = new Date().toLocaleString();
    document.getElementById("currentDateTime").textContent = currentDateTime;
  </script>

</body>
</html>
